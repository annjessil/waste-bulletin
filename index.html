<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>UCLA Waste Lookup</title>
</head>
<body>
  <h1>UCLA Waste Lookup</h1>
  
  <input type="text" placeholder="Search..." oninput="handleInput(event)">
  <ul id="results"></ul>

  <script>
    let allData = [];

    // Load the data once when the page loads
    fetch("./ucla_waste_data_complete.json")
      .then((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok " + response.statusText);
        }
        return response.json();
      })
      .then((json) => {
        allData = json;
      })
      .catch((error) => {
        console.error("Error fetching the data:", error);
      });

    function handleInput(event) {
      const value = event.target.value;
      fetchData(value);
    }

    function fetchData(value) {
      const results = allData.filter((item) => {
        return (
          value &&
          item &&
          item.name &&
          item.object &&
          item.mode &&
          (
            item.name.toLowerCase().includes(value.toLowerCase()) ||
            item.object.toLowerCase().includes(value.toLowerCase()) ||
            item.mode.toLowerCase().includes(value.toLowerCase())
          )
        );
      });
      setResults(results);
    }

    function setResults(results) {
      const resultsList = document.getElementById("results");
      resultsList.innerHTML = "";
      results.forEach((item) => {
        const li = document.createElement("li");
        li.textContent = `${item.name} â€” ${item.object} (${item.mode})`;
        resultsList.appendChild(li);
      });
    }
  </script>
</body>
</html>
